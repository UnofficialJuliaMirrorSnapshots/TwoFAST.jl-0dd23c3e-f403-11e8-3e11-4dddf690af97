! cdlgammma.f : log gamma(z)
      function cdlgamma(x)
      implicit complex*16 (a-h,t-z)
      implicit real*8 (o-s)
      parameter(
     &  pi= 3.14159265358979324d+00,
     &  pv= 7.31790632447016203d+00,
     &  pr= 1.66327323256597418d-03,
     &  p0= 5.07600435957593046d-02,
     &  p1= 5.35012283109043333d-01,
     &  p2= 2.40511969085241713d+00,
     &  p3= 4.62624880633891119d+00,
     &  p4= 3.36415438064135324d+00,
     &  p5= 6.71454520397933746d-01,
     &  p6= 1.49097237136722798d-02)
      parameter(
     &  q1= 9.99999999999975753d-01,
     &  q2= 2.00000000000603851d+00,
     &  q3= 2.99999999944915534d+00,
     &  q4= 4.00000003016801681d+00,
     &  q5= 4.99999857982434025d+00,
     &  q6= 6.00009857740312429d+00)
      w=x
      if(dreal(x).lt.0) w=1-x
      y=log(((((((p6/(w+q6)+p5)/(w+q5)+p4)/(w+q4)
     &  +p3)/(w+q3)+p2)/(w+q2)+p1)/(w+q1)+p0)/w+pr)
     &  +(w-0.5d0)*log(w+pv)-w
      if(dreal(x).lt.0) y=log(pi/sin(pi*x))-y
      r=0.5d0-dimag(y)/(2*pi)
      s=dint(r)-1
      cdlgamma=y+cmplx(0.0d0,(2*pi)*(dint(r-s)+s))
      end

